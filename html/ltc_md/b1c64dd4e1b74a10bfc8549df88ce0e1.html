

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<template id="tmpl_gotoTop"><div id="gotoTop">
  <button>Back to top</button>
</div></template>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3384. Team Dominance by Pass Success 🔒 &mdash; 优繆落 youmoula 1.0.0 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/goto-top/style.css?v=c152bd81" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=34088549"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/translations.js?v=beaddf03"></script>
      <script src="../_static/goto-top/main.js?v=69fc67a6"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            优繆落 youmoula
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">3384. Team Dominance by Pass Success 🔒</a><ul>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#solutions">Solutions</a><ul>
<li><a class="reference internal" href="#solution-1-equi-join-group-by-and-sum">Solution 1: Equi-Join + Group By and Sum</a><ul>
<li><a class="reference internal" href="#mysql">MySQL</a></li>
<li><a class="reference internal" href="#pandas">Pandas</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">优繆落 youmoula</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">3384. Team Dominance by Pass Success 🔒</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/ltc_md/b1c64dd4e1b74a10bfc8549df88ce0e1.md.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <!-- problem:start -->
<section id="team-dominance-by-pass-success">
<h1><a class="reference external" href="https://leetcode.com/problems/team-dominance-by-pass-success" rel="noreferrer" target="_blank">3384. Team Dominance by Pass Success 🔒 <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a><a class="headerlink" href="#team-dominance-by-pass-success" title="Link to this heading"></a></h1>
<p><a class="reference internal" href="#/solution/3300-3399/3384.Team%20Dominance%20by%20Pass%20Success/README.md"><span class="xref myst">中文文档</span></a></p>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading"></a></h2>
<!-- description:start -->
<p>Table: <code>Teams</code></p>
<pre>
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| player_id   | int     |
| team_name   | varchar | 
+-------------+---------+
player_id is the unique key for this table.
Each row contains the unique identifier for player and the name of one of the teams participating in that match.

</pre>
<p>Table: <code>Passes</code></p>
<pre>
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| pass_from   | int     |
| time_stamp  | varchar |
| pass_to     | int     |
+-------------+---------+
(pass_from, time_stamp) is the primary key for this table.
pass_from is a foreign key to player_id from Teams table.
Each row represents a pass made during a match, time_stamp represents the time in minutes (00:00-90:00) when the pass was made,
pass_to is the player_id of the player receiving the pass.

</pre>
<p>Write a solution to calculate the <strong>dominance score</strong> for each team in<strong> both halves of the match</strong>. The rules are as follows:</p>
<ul>
	<li>A match is divided into two halves: <strong>first half</strong> (<code>00:00</code>-<code><font face="monospace">45:00</font></code>&nbsp;minutes) and <strong>second half </strong>(<code>45:01</code>-<code>90:00</code> minutes)</li>
	<li>The dominance score is calculated based on successful and intercepted passes:
	<ul>
		<li>When pass_to is a player from the <strong>same team</strong>: +<code>1</code> point</li>
		<li>When pass_to is a player from the <strong>opposing team</strong> (interception): <code>-1</code> point</li>
	</ul>
	</li>
	<li>A higher dominance score indicates better passing performance</li>
</ul>
<p>Return <em>the result table ordered </em><em>by</em>&nbsp;<code>team_name</code> and&nbsp;<code>half_number</code> <em>in <strong>ascending</strong> order</em>.</p>
<p>The result format is in the following example.</p>
<p>&nbsp;</p>
<p><strong class="example">Example:</strong></p>
<div class="example-block">
<p><strong>Input:</strong></p>
<p>Teams table:</p>
<pre class="example-io">
+------------+-----------+
| player_id  | team_name |
+------------+-----------+
| 1          | Arsenal   |
| 2          | Arsenal   |
| 3          | Arsenal   |
| 4          | Chelsea   |
| 5          | Chelsea   |
| 6          | Chelsea   |
+------------+-----------+
</pre>
<p>Passes table:</p>
<pre class="example-io">
+-----------+------------+---------+
| pass_from | time_stamp | pass_to |
+-----------+------------+---------+
| 1         | 00:15      | 2       |
| 2         | 00:45      | 3       |
| 3         | 01:15      | 1       |
| 4         | 00:30      | 1       |
| 2         | 46:00      | 3       |
| 3         | 46:15      | 4       |
| 1         | 46:45      | 2       |
| 5         | 46:30      | 6       |
+-----------+------------+---------+
</pre>
<p><strong>Output:</strong></p>
<pre class="example-io">
+-----------+-------------+-----------+
| team_name | half_number | dominance |
+-----------+-------------+-----------+
| Arsenal   | 1           | 3         |
| Arsenal   | 2           | 1         |
| Chelsea   | 1           | -1        |
| Chelsea   | 2           | 1         |
+-----------+-------------+-----------+
</pre>
<p><strong>Explanation:</strong></p>
<ul>
	<li><strong>First Half (00:00-45:00):</strong>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;ul&gt;
	&lt;li&gt;Arsenal&amp;#39;s passes:
	&lt;ul&gt;
		&lt;li&gt;1 &amp;rarr; 2 (00:15): Successful pass (+1)&lt;/li&gt;
		&lt;li&gt;2 &amp;rarr; 3 (00:45): Successful pass (+1)&lt;/li&gt;
		&lt;li&gt;3 &amp;rarr; 1 (01:15): Successful pass (+1)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Chelsea&amp;#39;s passes:
	&lt;ul&gt;
		&lt;li&gt;4 &amp;rarr; 1 (00:30): Intercepted by Arsenal (-1)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Second Half (45:01-90:00):&lt;/strong&gt;
&lt;ul&gt;
	&lt;li&gt;Arsenal&amp;#39;s passes:
	&lt;ul&gt;
		&lt;li&gt;2 &amp;rarr; 3 (46:00): Successful pass (+1)&lt;/li&gt;
		&lt;li&gt;3 &amp;rarr; 4 (46:15): Intercepted by Chelsea (-1)&lt;/li&gt;
		&lt;li&gt;1 &amp;rarr; 2 (46:45): Successful pass (+1)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Chelsea&amp;#39;s passes:
	&lt;ul&gt;
		&lt;li&gt;5 &amp;rarr; 6 (46:30): Successful pass (+1)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The results are ordered by team_name and then half_number&lt;/li&gt;
</pre></div>
</div>
</ul>
</div>
<!-- description:end -->
</section>
<section id="solutions">
<h2>Solutions<a class="headerlink" href="#solutions" title="Link to this heading"></a></h2>
<!-- solution:start -->
<section id="solution-1-equi-join-group-by-and-sum">
<h3>Solution 1: Equi-Join + Group By and Sum<a class="headerlink" href="#solution-1-equi-join-group-by-and-sum" title="Link to this heading"></a></h3>
<p>We can use an equi-join to find the teams of both the passer and the receiver for each pass. Then, based on the timestamp, we determine whether the pass occurred in the first half or the second half. By checking if the passer and receiver belong to the same team, we calculate the advantage value for each pass. Finally, we group by team name and half number, and sum the advantage values to get the advantage value for each team in the first and second halves.</p>
<!-- tabs:start -->
<section id="mysql">
<h4>MySQL<a class="headerlink" href="#mysql" title="Link to this heading"></a></h4>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">#</span><span class="w"> </span><span class="k">Write</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">MySQL</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="k">statement</span><span class="w"> </span><span class="n">below</span>
<span class="k">WITH</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="k">SELECT</span>
<span class="w">            </span><span class="n">t1</span><span class="p">.</span><span class="n">team_name</span><span class="p">,</span>
<span class="w">            </span><span class="k">IF</span><span class="p">(</span><span class="n">time_stamp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s1">&#39;45:00&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">half_number</span><span class="p">,</span>
<span class="w">            </span><span class="k">IF</span><span class="p">(</span><span class="n">t1</span><span class="p">.</span><span class="n">team_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="n">team_name</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">dominance</span>
<span class="w">        </span><span class="k">FROM</span>
<span class="w">            </span><span class="n">Passes</span><span class="w"> </span><span class="n">p</span>
<span class="w">            </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Teams</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pass_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">player_id</span>
<span class="w">            </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Teams</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">pass_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="n">player_id</span>
<span class="w">    </span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">team_name</span><span class="p">,</span><span class="w"> </span><span class="n">half_number</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">dominance</span><span class="p">)</span><span class="w"> </span><span class="n">dominance</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">T</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="pandas">
<h4>Pandas<a class="headerlink" href="#pandas" title="Link to this heading"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>


<span class="k">def</span><span class="w"> </span><span class="nf">calculate_team_dominance</span><span class="p">(</span><span class="n">teams</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">passes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">passes_with_teams</span> <span class="o">=</span> <span class="n">passes</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">teams</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;pass_from&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;player_id&quot;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;_team_from&quot;</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">teams</span><span class="p">,</span>
        <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;pass_to&quot;</span><span class="p">,</span>
        <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;player_id&quot;</span><span class="p">,</span>
        <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_team_from&quot;</span><span class="p">,</span> <span class="s2">&quot;_team_to&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">passes_with_teams</span><span class="p">[</span><span class="s2">&quot;half_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">passes_with_teams</span><span class="p">[</span><span class="s2">&quot;time_stamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="s2">&quot;45:00&quot;</span> <span class="k">else</span> <span class="mi">2</span>
    <span class="p">)</span>
    <span class="n">passes_with_teams</span><span class="p">[</span><span class="s2">&quot;dominance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">passes_with_teams</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;team_name_team_from&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;team_name_team_to&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">passes_with_teams</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;team_name_team_from&quot;</span><span class="p">,</span> <span class="s2">&quot;half_number&quot;</span><span class="p">])[</span><span class="s2">&quot;dominance&quot;</span><span class="p">]</span>
        <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;team_name&quot;</span><span class="p">,</span> <span class="s2">&quot;half_number&quot;</span><span class="p">,</span> <span class="s2">&quot;dominance&quot;</span><span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;team_name&quot;</span><span class="p">,</span> <span class="s2">&quot;half_number&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<!-- tabs:end -->
<!-- solution:end -->
<!-- problem:end -->
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2025, youmoula.com。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>